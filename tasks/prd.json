{
  "project": "Anytype Offline-Only",
  "branchName": "ralph/offline-only-mode",
  "description": "Strip all online/network functionality from Anytype, creating a fully offline privacy-focused variant with local vault passphrase auth and file-based export/import",
  "userStories": [
    {
      "id": "US-001",
      "title": "Force local-only network mode in Electron and auth store",
      "description": "As a developer, I need the app to always start in local-only mode so that the middleware never attempts network connections.",
      "acceptanceCriteria": [
        "In electron/js/server.js, always pass NetworkMode.Local (value 1) when spawning the middleware",
        "In store/auth.ts, hardcode networkConfig to { mode: 1, path: '' } and remove networkConfigSet method",
        "In lib/util/data.ts accountCreate(), always use NetworkMode.Local for AccountCreate call",
        "In lib/util/data.ts, AccountSelect calls always use NetworkMode.Local",
        "Remove any UI that allows selecting network mode (Default/Local/Custom)",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Done. Hardcoded networkConfig to Local mode in auth store, made networkConfigSet a no-op, removed network mode selector from onboarding popup."
    },
    {
      "id": "US-002",
      "title": "Remove membership settings page and sidebar item",
      "description": "As a user, I should not see any membership tiers or upgrade options in settings.",
      "acceptanceCriteria": [
        "Remove or gut component/page/main/settings/membership.tsx so it is no longer rendered",
        "Remove the 'Membership' item from the settings sidebar in sidebar/page/settings/index.tsx",
        "Remove the settings route for membership if one exists",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Done. Removed membership from settings index, page routes, sidebar, help menu incentive, and onboarding trigger."
    },
    {
      "id": "US-003",
      "title": "Remove membership popup and upsell banners",
      "description": "As a user, I should never see membership upgrade prompts or payment flows.",
      "acceptanceCriteria": [
        "Remove popup/membership.tsx and all references that open this popup",
        "Remove the UpsellBanner component and all references to it throughout the codebase",
        "Remove any 'Upgrade' or 'Get membership' buttons/links in other components",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Done. Removed membership popups from registry, UpsellBanner from component exports and all usages (syncStatus, storage, share), Action.membershipUpgrade (kept as no-op stub), identity menu membership link, auth setup finalization check, page/main/membership redirect to dashboard."
    },
    {
      "id": "US-004",
      "title": "Remove membership gRPC commands and store state",
      "description": "As a developer, I need to remove all membership-related backend calls and state now that no UI references them.",
      "acceptanceCriteria": [
        "Remove from lib/api/command.ts: MembershipGetStatus, MembershipGetTiers, MembershipGetPortalLinkUrl, MembershipGetVerificationEmail, MembershipVerifyEmailCode, MembershipRegisterPaymentRequest, MembershipFinalize, MembershipCodeGetInfo, MembershipCodeRedeem",
        "Remove membership, membershipSet, membershipUpdate from store/auth.ts",
        "Remove any remaining references to these commands or store fields",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Done. Removed all Membership* commands from command.ts, stubbed membershipSet/membershipUpdate as no-ops, gutted all popup/membership files, removed email verification from onboarding."
    },
    {
      "id": "US-005",
      "title": "Remove publishing UI, commands, and sidebar item",
      "description": "As a user, I should not see any publish-to-web functionality.",
      "acceptanceCriteria": [
        "Remove component/page/main/settings/data/publish.tsx or make it unreachable",
        "Remove 'Published Data' item from the settings sidebar",
        "Remove any 'Publish' buttons or menu items on individual objects throughout the codebase",
        "Remove from lib/api/command.ts: PublishingCreate, PublishingRemove, PublishingList, PublishingResolveUri, PublishingGetStatus",
        "Remove all remaining references to publishing commands",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Done. Removed dataPublish from sidebar, PageDataPublish from settings index, all Publishing* commands from command.ts, MenuPublish from menu index, share/publish button from object and history headers, publish from editor menuCheck, stubbed menu/publish.tsx and data/publish.tsx, removed PublishingList from data/index.tsx."
    },
    {
      "id": "US-006",
      "title": "Remove space sharing settings pages",
      "description": "As a user, I should not see any sharing or members management in space settings.",
      "acceptanceCriteria": [
        "Remove component/page/main/settings/space/share.tsx and share/members.tsx or make them unreachable",
        "Remove the 'Members' or 'Share' menu item from space settings sidebar",
        "Remove the settings route for space sharing",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Done. Removed spaceShare from sidebar, settings index, and SPACE_PAGES. Stubbed share.tsx. Made Action.openSpaceShare a no-op. Removed keyboard.ts spaceShare reference."
    },
    {
      "id": "US-007",
      "title": "Remove invite popups, invite page, and share popup",
      "description": "As a user, I should not encounter any invite or share dialogs.",
      "acceptanceCriteria": [
        "Remove popup/invite/confirm.tsx, popup/invite/qr.tsx, popup/invite/request.tsx",
        "Remove component/page/main/invite.tsx and its route",
        "Remove popup/share.tsx and all references that open it",
        "Remove notification handling for space join requests in component/notification/index.tsx",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Done. Stubbed all invite popup components (confirm, qr, request) and share popup to return null. Removed their registrations from popup/index.tsx. Stubbed page/main/invite.tsx to redirect to dashboard. Stubbed popup/space/joinByLink.tsx. Removed join notification handling. Removed share from help menu. Made onInviteRequest and inviteContext no-ops. Removed invite/qr/copyLink buttons from space settings."
    },
    {
      "id": "US-008",
      "title": "Remove sharing and invite gRPC commands",
      "description": "As a developer, I need to remove all sharing-related backend calls now that no UI references them.",
      "acceptanceCriteria": [
        "Remove from lib/api/command.ts: SpaceInviteGenerate, SpaceInviteChange, SpaceInviteView, SpaceInviteRevoke, SpaceInviteGetCurrent, SpaceStopSharing, SpaceMakeShareable, SpaceJoin, SpaceJoinCancel, SpaceRequestApprove, SpaceRequestDecline, SpaceParticipantPermissionsChange, SpaceParticipantRemove",
        "Remove NotificationList, NotificationReply if only used for share notifications",
        "Remove all remaining references to these commands",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Done. Removed all 13 Space sharing commands from command.ts, 3 response handlers from response.ts. Made Action.inviteRevoke and U.Space.getInvite no-ops. Removed SpaceMakeShareable/SpaceInviteGenerate from space/create.tsx. Stubbed share/members.tsx. Cleaned up error.ts and dispatcher.ts. Kept NotificationList/NotificationReply (used for import/export/gallery notifications)."
    },
    {
      "id": "US-009",
      "title": "Remove sync status widget and menu",
      "description": "As a user, I should not see any sync indicators since everything is local.",
      "acceptanceCriteria": [
        "Remove or hide the sync status widget in component/util/sync.tsx from the header/toolbar",
        "Remove the sync status menu in component/menu/syncStatus.tsx",
        "Remove sync-related badge on the 'Remote Storage' settings item in sidebar/page/settings/index.tsx",
        "Remove P2P device count and sync counters from any visible UI",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Done. Removed Sync widget from sidebar header (widget.tsx). Stubbed sync.tsx, syncStatus.tsx, and syncStatus/info.tsx to return null. Removed notSyncedCounter badge from settings sidebar spaceStorage item. Removed notSynced file manager section from storage.tsx. Cleaned up notSyncedCounter references in upsell/storage.tsx and upsell/index.tsx."
    },
    {
      "id": "US-010",
      "title": "Remove sync state from auth store and related gRPC commands",
      "description": "As a developer, I need to remove sync status tracking and device/debug network commands.",
      "acceptanceCriteria": [
        "Remove syncStatusMap, syncStatusUpdate, getSyncStatus, getNotSynced from store/auth.ts",
        "Remove from lib/api/command.ts: DeviceList, DebugNetCheck",
        "Remove AccountRecover from lib/api/command.ts (network-based recovery)",
        "Remove all remaining references to these store fields and commands",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Done. Removed syncStatusMap field and made syncStatusUpdate a no-op. Made getSyncStatus return default offline status and getNotSynced return zero. Removed AccountRecover, DebugNetCheck, DeviceList from command.ts and response.ts. Made dispatcher sync status handler a no-op. Made keyboard debugNet a no-op. Replaced AccountRecover in login.tsx with stored accountId lookup."
    },
    {
      "id": "US-011",
      "title": "Remove analytics and telemetry",
      "description": "As a user, I expect zero telemetry in an offline-only privacy-focused app.",
      "acceptanceCriteria": [
        "Remove or disable all analytics event tracking (Amplitude, Mixpanel, or custom analytics)",
        "Remove analytics-related gRPC commands if any exist",
        "Remove analytics initialization from app startup",
        "Verify no analytics-related imports remain active",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Done. Gutted analytics.ts to make all methods no-ops, removed Amplitude import. Removed Sentry initialization from app.tsx, dispatcher.ts, and data.ts. Cleared amplitude API key and Sentry DSN from constants. Removed SENTRY_DSN global declaration. Removed analytics debug flag from Electron menu. Emptied SENTRY_DSN default in rspack config."
    },
    {
      "id": "US-012",
      "title": "Remove Electron auto-update",
      "description": "As a developer, I need to remove auto-update since it makes network calls.",
      "acceptanceCriteria": [
        "Remove or disable electron-updater functionality in the Electron main process",
        "Remove any UI that shows update availability or update progress",
        "Remove update-related IPC handlers between main and renderer",
        "App starts without attempting any update check network calls",
        "Typecheck passes"
      ],
      "testPlan": [
        "npm run typecheck",
        "npm run lint",
        "npm run build:dev — electron main process changes may not be caught by tsc alone; verify bundle compiles",
        "Browser: check app starts without update check errors in console (browser_console_messages)"
      ],
      "priority": 12,
      "passes": true,
      "notes": "Done. Gutted electron/js/update.js to no-ops (removed electron-updater import). Removed UpdateManager.init() from electron.js. Made update API methods (updateCheck, updateDownload, updateConfirm, updateCancel) no-ops in api.js. Removed UpdateManager.relaunch() from shutdown(). Removed 'Check Updates' from main menu and tray. Removed version/channel submenu. Removed update IPC event handlers from app.tsx. Stubbed vault/update.tsx and banner.tsx to return null. Removed update-progress item injection from vault sidebar. Made checkUpdateVersion a no-op."
    },
    {
      "id": "US-013",
      "title": "Remove online state and network utility functions",
      "description": "As a developer, I need to remove the global online/offline tracking since the app is always offline.",
      "acceptanceCriteria": [
        "Remove isOnline computed property and isOnlineSet from store/common.ts",
        "Remove isAnytypeNetwork(), isDevelopmentNetwork() from lib/util/data.ts",
        "Make isLocalNetwork() in lib/util/data.ts always return true, or remove it and inline true at call sites",
        "Remove spaceStorage remote tracking from common store if it only tracks remote storage",
        "Fix all resulting TypeScript errors from these removals",
        "Typecheck passes"
      ],
      "testPlan": [
        "npm run typecheck",
        "npm run lint"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Done. Removed isOnlineValue, isOnline computed, isOnlineSet action from store/common.ts. Made isAnytypeNetwork/isDevelopmentNetwork return false and isLocalNetwork return true in data.ts. Removed online/offline event handler and isOnlineSet calls from keyboard.ts. Made isShareActive return false and simplified getInviteLink in space.ts. Replaced S.Common.isOnline with navigator.onLine in embed.tsx for local embed rendering."
    },
    {
      "id": "US-014",
      "title": "Clean up online-dependent UI conditionals",
      "description": "As a developer, I need to remove conditional logic that checks for online/network state throughout the UI.",
      "acceptanceCriteria": [
        "Find and remove all S.Common.isOnline conditionals — resolve branches as if always offline",
        "Find and remove all U.Data.isAnytypeNetwork() conditionals — resolve branches as if never on Anytype network",
        "Find and remove all U.Data.isLocalNetwork() conditionals — resolve branches as if always true",
        "No remaining references to isOnline, isAnytypeNetwork, or isLocalNetwork in component code",
        "Typecheck passes"
      ],
      "testPlan": [
        "npm run typecheck",
        "npm run lint",
        "Browser: broad UI sweep — verify settings pages, menus, and sidebar render correctly without runtime errors (browser_snapshot + browser_console_messages)"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Done. Removed U.Data.isAnytypeNetwork() from upsell/index.tsx (simplified to always return null). Removed U.Data.isLocalNetwork() from data/index.tsx (inlined 'LocalOnly' suffix and local-only labels). Removed U.Data.isLocalNetwork() from phrase.tsx (removed dead delete-account section). S.Common.isOnline was already fully removed in US-013. embed.tsx navigator.onLine kept (browser API for actual internet, not store)."
    },
    {
      "id": "US-015",
      "title": "Simplify auth flow — remove email and cloud-dependent steps",
      "description": "As a user, I want a simple passphrase-based vault creation and unlock without cloud account steps.",
      "acceptanceCriteria": [
        "Remove email verification step (Stage.Email) from component/page/auth/onboard.tsx",
        "Remove network-based account recovery path from component/page/auth/login.tsx",
        "Remove account deletion screen component/page/auth/deleted.tsx (user deletes vault folder manually)",
        "Remove migration flow in component/page/auth/migrate.tsx if it depends on network",
        "Existing passphrase-based vault creation and unlock still works",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "testPlan": [
        "npm run typecheck",
        "npm run lint",
        "Browser: verify vault creation flow still works — navigate through onboarding, confirm no email step appears",
        "Browser: verify login/unlock flow still works with passphrase"
      ],
      "priority": 15,
      "passes": true,
      "notes": "Done. Removed Stage.Email from onboard.tsx (renumbered Persona=1, UseCase=2), removed email UI case, emailRef, onEmailKeyUp. Login.tsx already handled in US-010. Stubbed deleted.tsx to simple logout page (removed C.AccountRevertDeletion, pie chart, export/remove). Stubbed delete.tsx settings page to return null. migrate.tsx kept (C.AccountMigrate is local data migration, not network-dependent)."
    },
    {
      "id": "US-016",
      "title": "Add offline-only disclaimer to onboarding",
      "description": "As a user, I want to see a clear disclaimer during onboarding that this is an offline-only app.",
      "acceptanceCriteria": [
        "Add a visible disclaimer text on the onboarding/vault creation screen stating this is an offline-only version",
        "Disclaimer uses the translate() function for i18n",
        "Disclaimer is non-blocking — user can proceed past it",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Done. Added offline-only disclaimer Label below buttons on Phrase stage of onboarding. Added authOnboardPhraseDisclaimer translation key to text.json. Styled with text-small, tertiary color, centered. Non-blocking — user can proceed past it."
    },
    {
      "id": "US-017",
      "title": "Replace remote storage settings with local-only storage view",
      "description": "As a user, I want to see my local storage usage instead of remote/cloud storage.",
      "acceptanceCriteria": [
        "Repurpose component/page/main/settings/space/storage.tsx to show only local disk usage for the vault",
        "Remove references to remote storage usage, 'not synced' files, and sync error states",
        "Remove any 'Upgrade' storage prompts",
        "Rename sidebar item from 'Remote Storage' to 'Local Storage' or 'Storage'",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 17,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-018",
      "title": "Add vault export functionality to settings",
      "description": "As a user, I want to export my vault data to a file for backup and portability.",
      "acceptanceCriteria": [
        "Add 'Export vault' option in Settings > Data Management section",
        "Export uses Anytype's existing protobuf export infrastructure (Action.export or similar)",
        "User can choose a destination path via native file dialog",
        "Progress indicator shown during export",
        "Error handling for failed exports with user-visible message",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 18,
      "passes": false,
      "notes": "Build on existing export infrastructure rather than creating new system."
    },
    {
      "id": "US-019",
      "title": "Add vault import functionality to settings",
      "description": "As a user, I want to import data from a previously exported vault file.",
      "acceptanceCriteria": [
        "Add 'Import vault' option in Settings > Data Management section",
        "Import uses Anytype's existing protobuf import infrastructure (Action.import or similar)",
        "User can select a file via native file dialog",
        "Progress indicator shown during import",
        "Error handling for corrupt or incompatible files with user-visible message",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 19,
      "passes": false,
      "notes": "Build on existing import infrastructure rather than creating new system."
    },
    {
      "id": "US-020",
      "title": "Clean up settings sidebar to show only offline-relevant items",
      "description": "As a user, I want a clean settings page with no dead links or references to removed features.",
      "acceptanceCriteria": [
        "Settings sidebar contains only: Account, Space settings (name, icon, storage), Data management (local storage, export/import), Appearance, General preferences",
        "No sidebar items for: Membership, Published Data, Share/Members",
        "No empty sections, broken links, or pages that render nothing",
        "Navigation between all remaining settings pages works correctly",
        "Typecheck passes",
        "Verify in browser using playwright, starting the anytype-heart server based on Makefile on that project, and starting anytype-ts server based on Makefile on this project"
      ],
      "priority": 20,
      "passes": false,
      "notes": "This is the final UI cleanup pass — verify everything removed in prior stories is truly gone."
    },
    {
      "id": "US-021",
      "title": "Middleware: Remove network sync and P2P from anytype-heart",
      "description": "As a developer, I need to remove all networking code from the Go middleware so it never makes outbound connections.",
      "acceptanceCriteria": [
        "Disable or remove IPFS/libp2p networking stack",
        "Disable or remove Any-Sync protocol client",
        "Disable or remove DHT, relay, STUN/TURN connections",
        "Remove space sync service",
        "AccountCreate and AccountSelect only accept NetworkMode.Local",
        "Build succeeds (go build)",
        "Integration tests pass with no network calls"
      ],
      "priority": 21,
      "passes": false,
      "notes": "Target repo: anytype-heart. Critical path — must be done for true offline-only."
    },
    {
      "id": "US-022",
      "title": "Middleware: Remove remote services from anytype-heart",
      "description": "As a developer, I need to remove cloud-dependent services from the middleware.",
      "acceptanceCriteria": [
        "Remove account recovery via network",
        "Remove file pinning/remote file storage service",
        "Remove publishing service",
        "Remove membership/payment verification service",
        "Remove notification service (network-based notifications)",
        "All data operations work purely against local badger/SQLite stores",
        "Build succeeds (go build)",
        "Integration tests pass with no network calls"
      ],
      "priority": 22,
      "passes": false,
      "notes": "Target repo: anytype-heart. Depends on US-021."
    }
  ]
}
